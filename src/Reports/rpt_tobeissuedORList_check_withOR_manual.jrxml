<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="612" pageHeight="936" whenNoDataType="AllSectionsNoDetail" columnWidth="540" leftMargin="36" rightMargin="36" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.539474354692127"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="97"/>
	<style name="style1"/>
	<parameter name="01_Company" class="java.lang.String">
		<defaultValueExpression><![CDATA["CENQHOMES DEVELOPMENT CORPORATION"]]></defaultValueExpression>
	</parameter>
	<parameter name="07_User" class="java.lang.String">
		<defaultValueExpression><![CDATA["edapostol"]]></defaultValueExpression>
	</parameter>
	<parameter name="08_dateFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[null]]></defaultValueExpression>
	</parameter>
	<parameter name="09_dateTo" class="java.util.Date"/>
	<queryString>
		<![CDATA[select (row_number() over(order by a.or_date, a.or_no, b.entity_name, c.description, a.check_date))::int as row,
coalescE((
	select date_created::Date
	from rf_check_history
	where pay_rec_id::int = a.pay_rec_id::int and new_checkstat_id = '01'
	and status_id = 'A'
	limit 1
), null) as cleared_date,
coalescE((
	select y.tran_date::Date
	from rf_payments x
	inner join rf_buyer_status y on x.entity_id = x.entity_id and x.proj_id = y.proj_id
	and x.pbl_id = y.pbl_id and x.seq_no::int = y.seq_no::int and y.byrstatus_id = '01' and y.status_id = 'A'
	where x.pay_rec_id::int = a.pay_rec_id::int and x.status_id = 'A'
), null) as officially_reserved,
(
	select x.lts_date::date
	from mf_sub_project x
	inner join mf_unit_info y on y.proj_id = x.proj_id and y.phase = x.phase
	inner join rf_payments z on y.proj_id = z.proj_id and y.pbl_id = z.pbl_id
	where z.pay_rec_id::int = a.pay_rec_id::int
) as lts_date,
(
	select boi::date
	from mf_sub_project x
	inner join mf_unit_info y on y.proj_id = x.proj_id and y.phase = x.phase
	inner join rf_payments z on y.proj_id = z.proj_id and y.pbl_id = z.pbl_id
	where z.pay_rec_id::int = a.pay_rec_id::int
) as boi_ruling, b.entity_name as name, c.description as unit, d.particulars,
(case when a.pymnt_type = 'A' then 'CASH' else 'CHECK' end) as type, a.amount, a.trans_date,
(select sp_compute_payment_percentage(a.entity_id, a.proj_id, a.pbl_id, a.seq_no, a.pay_rec_id) from rf_payments x where x.pay_rec_id::int = a.pay_rec_id::int) as percentage,
a.pay_rec_id, a.check_no, a.check_date, a.or_no,
(select x.date_issued from cs_receipt_details x where x.receipt_no = a.or_no and x.issued_to = a.entity_id and x.doc_id = '01' limit 1) as date_issued,
(select x.time_issued from cs_receipt_details x where x.receipt_no = a.or_no and x.issued_to = a.entity_id and x.doc_id = '01' limit 1) as time_issued,
(select x.issued_by from cs_receipt_details x where x.receipt_no = a.or_no and x.issued_to = a.entity_id and x.doc_id = '01' limit 1) as issued_by,
a.or_date::date as or_date,
(select x.jv_no from rf_jv_header x where x.remarks ~* ('TO RECORD THE ADJUSTMENTS FOR THE COLLECTION DATE ' || a.or_date::date::varchar)::varchar and status_id != 'D') as jv_no
from rf_payments a
inner join rf_entity b on a.entity_id = b.entity_id
inner join mf_unit_info c on a.proj_id = c.proj_id and a.pbl_id = c.pbl_id
inner join mf_pay_particular d on a.pay_part_id = d.pay_part_id
where (a.remarks ~* 'Late LTS/BOI' or a.remarks ~* 'Late OR Issuance for Good Check')
and a.or_date::date between $P{08_dateFrom} and $P{09_dateTo}
order by a.or_date, a.or_no, b.entity_name, c.description, a.check_date]]>
	</queryString>
	<field name="row" class="java.lang.Integer"/>
	<field name="cleared_date" class="java.sql.Date"/>
	<field name="officially_reserved" class="java.sql.Date"/>
	<field name="lts_date" class="java.sql.Date"/>
	<field name="boi_ruling" class="java.sql.Date"/>
	<field name="name" class="java.lang.String"/>
	<field name="unit" class="java.lang.String"/>
	<field name="particulars" class="java.lang.String"/>
	<field name="type" class="java.lang.String"/>
	<field name="amount" class="java.math.BigDecimal"/>
	<field name="trans_date" class="java.sql.Timestamp"/>
	<field name="percentage" class="java.math.BigDecimal"/>
	<field name="pay_rec_id" class="java.lang.Integer"/>
	<field name="check_no" class="java.lang.String"/>
	<field name="check_date" class="java.sql.Timestamp"/>
	<field name="or_no" class="java.lang.String"/>
	<field name="date_issued" class="java.sql.Timestamp"/>
	<field name="time_issued" class="java.lang.String"/>
	<field name="issued_by" class="java.lang.String"/>
	<field name="or_date" class="java.sql.Date"/>
	<field name="jv_no" class="java.lang.String"/>
	<variable name="rowCount" class="java.lang.Number" calculation="DistinctCount">
		<variableExpression><![CDATA[$F{name}]]></variableExpression>
	</variable>
	<variable name="sub_orDate" class="java.math.BigDecimal" resetType="Group" resetGroup="grp_orDate" calculation="Sum">
		<variableExpression><![CDATA[$F{amount}]]></variableExpression>
	</variable>
	<variable name="gran_orDate" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{amount}]]></variableExpression>
	</variable>
	<group name="GrandTotal">
		<groupFooter>
			<band height="17">
				<line>
					<reportElement x="0" y="16" width="540" height="1"/>
				</line>
				<textField>
					<reportElement x="0" y="0" width="52" height="16"/>
					<box leftPadding="0"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Grand Total: "]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="243" y="0" width="67" height="16"/>
					<box rightPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{gran_orDate}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="52" y="0" width="89" height="16"/>
					<box leftPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$V{GrandTotal_COUNT}.toString() + " Unit(s)"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="141" y="0" width="102" height="16"/>
					<box leftPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Amount: "]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="grp_orDate">
		<groupExpression><![CDATA[$F{or_date}]]></groupExpression>
		<groupHeader>
			<band height="23">
				<line>
					<reportElement x="0" y="21" width="540" height="1"/>
				</line>
				<textField pattern="MM/dd/yyyy">
					<reportElement x="0" y="6" width="310" height="16"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["OR Date: " + $F{or_date}.toString()]]></textFieldExpression>
				</textField>
				<textField pattern="MM/dd/yyyy">
					<reportElement x="310" y="6" width="230" height="16"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["JV No." + $F{jv_no}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="22">
				<line>
					<reportElement x="0" y="5" width="540" height="1"/>
				</line>
				<textField>
					<reportElement x="141" y="6" width="102" height="16"/>
					<box leftPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Amount: "]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="0" y="21" width="540" height="1"/>
				</line>
				<textField pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="243" y="6" width="67" height="15"/>
					<box rightPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sub_orDate}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="0" y="6" width="52" height="15"/>
					<box leftPadding="0"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Subtotal: "]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="52" y="6" width="89" height="15"/>
					<box leftPadding="3"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$V{grp_orDate_COUNT}.toString() + " Unit(s)"]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="67" splitType="Stretch">
			<textField>
				<reportElement x="0" y="7" width="464" height="17"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{01_Company}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM dd, yyyy">
				<reportElement x="414" y="24" width="126" height="15"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="414" y="39" width="126" height="15"/>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="24" width="273" height="15"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Tahoma" size="10" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Receipts For OR Issuance"]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="42" splitType="Stretch">
			<elementGroup>
				<staticText>
					<reportElement x="259" y="0" width="51" height="20"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Amount]]></text>
				</staticText>
				<staticText>
					<reportElement x="231" y="0" width="28" height="20"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Type]]></text>
				</staticText>
				<staticText>
					<reportElement x="16" y="0" width="125" height="20" backcolor="#00FFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Client's Name]]></text>
				</staticText>
				<staticText>
					<reportElement x="141" y="0" width="60" height="20"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Tahoma" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Unit]]></text>
				</staticText>
				<staticText>
					<reportElement x="201" y="0" width="30" height="20"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Tahoma" size="6" isBold="true"/>
					</textElement>
					<text><![CDATA[Particular]]></text>
				</staticText>
			</elementGroup>
			<textField>
				<reportElement x="0" y="23" width="540" height="16"/>
				<box>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Carlito" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["F  O  R    O  F  F  I  C  I  A  L    R  E  C  E  I  P  T    I  S  S  U  A  N  C  E"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="500" y="0" width="40" height="20"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[Payment Percentage]]></text>
			</staticText>
			<staticText>
				<reportElement x="310" y="0" width="50" height="20"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[Officially Reserved Date]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="16" height="20" backcolor="#00FFFF"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Row]]></text>
			</staticText>
			<staticText>
				<reportElement x="360" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Date Cleared]]></text>
			</staticText>
			<staticText>
				<reportElement x="450" y="0" width="50" height="20"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[OR Date]]></text>
			</staticText>
			<staticText>
				<reportElement x="410" y="0" width="40" height="20"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[OR No.]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="21" splitType="Stretch">
			<textField>
				<reportElement x="16" y="0" width="125" height="21"/>
				<box leftPadding="3"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="141" y="0" width="60" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{unit}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="201" y="0" width="30" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
					<paragraph tabStopWidth="30"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{particulars}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="231" y="0" width="28" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{type}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="259" y="0" width="51" height="21"/>
				<box rightPadding="3"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="310" y="0" width="50" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{officially_reserved}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy" isBlankWhenNull="true">
				<reportElement x="360" y="0" width="50" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{cleared_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="500" y="0" width="40" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{percentage}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="16" height="21"/>
				<box rightPadding="3"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{row}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="450" y="0" width="50" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{or_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="410" y="0" width="40" height="21"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{or_no}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="9" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="81" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="22" width="180" height="20"/>
				<box>
					<leftPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" isBold="false"/>
				</textElement>
				<text><![CDATA[Prepared by:]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="58" width="150" height="20"/>
				<box>
					<bottomPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{07_User}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="360" y="22" width="180" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" isBold="false"/>
				</textElement>
				<text><![CDATA[Received by:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="360" y="58" width="150" height="20"/>
				<box>
					<bottomPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.lang.String"><![CDATA[]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
