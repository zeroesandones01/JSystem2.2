<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rptSubmittedDocuments" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="432"/>
	<property name="ireport.y" value="0"/>
	<parameter name="entity_id" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["0000000100"]]></defaultValueExpression>
	</parameter>
	<parameter name="proj_id" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["015"]]></defaultValueExpression>
	</parameter>
	<parameter name="pbl_id" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["241"]]></defaultValueExpression>
	</parameter>
	<parameter name="seq_no" class="java.lang.Integer" isForPrompting="false">
		<defaultValueExpression><![CDATA[1]]></defaultValueExpression>
	</parameter>
	<parameter name="prepared_by" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["aagonzales"]]></defaultValueExpression>
	</parameter>
	<parameter name="client_name" class="java.lang.String" isForPrompting="false"/>
	<parameter name="company" class="java.lang.String" isForPrompting="false"/>
	<queryString>
		<![CDATA[SELECT b.doc_desc, a.no_copies, a.date_submitted, c.received_from,
CASE WHEN timestamp_gt(a.docs_out, COALESCE(a.docs_in, timestamp_mi_interval(a.docs_out, interval '1 DAY'))) THEN a.docs_out ELSE NULL END as docs_out,
CASE WHEN timestamp_gt(a.docs_in, a.docs_out) THEN a.docs_in ELSE NULL END as docs_in, e.company_alias
FROM rf_buyer_documents a
LEFT JOIN mf_doc_details b ON b.doc_id = a.doc_id
LEFT JOIN dm_docs_inout c ON c.entity_id = a.entity_id and c.proj_id = a.projcode and c.pbl_id = a.pbl_id and c.seq_no = a.seq_no and c.doc_id = a.doc_id
LEFT JOIN mf_project d ON d.proj_id = a.projcode
LEFT JOIN mf_company e ON e.co_id = d.co_id
WHERE a.entity_id = $P{entity_id}
AND a.projcode = $P{proj_id}
AND a.pbl_id = $P{pbl_id}
AND a.seq_no = $P{seq_no}
ORDER BY TRIM(b.doc_desc), c.received_date;]]>
	</queryString>
	<field name="doc_desc" class="java.lang.String"/>
	<field name="no_copies" class="java.lang.Integer"/>
	<field name="date_submitted" class="java.sql.Timestamp"/>
	<field name="received_from" class="java.lang.String"/>
	<field name="docs_out" class="java.sql.Timestamp"/>
	<field name="docs_in" class="java.sql.Timestamp"/>
	<field name="company_alias" class="java.lang.String"/>
	<variable name="CURRENT_PAGE_NUMBER" class="java.lang.Integer" resetType="Page">
		<variableExpression><![CDATA[$V{PAGE_NUMBER}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<title>
		<band height="40" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="22" width="352" height="18"/>
				<textElement verticalAlignment="Top">
					<font fontName="Tahoma"/>
				</textElement>
				<text><![CDATA[List of Submitted Documents]]></text>
			</staticText>
			<textField>
				<reportElement mode="Opaque" x="0" y="0" width="572" height="22" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{company}.trim()]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="52" splitType="Stretch">
			<textField>
				<reportElement x="0" y="28" width="305" height="24"/>
				<textElement>
					<font fontName="Tahoma" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{client_name}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" evaluationTime="Auto">
				<reportElement positionType="Float" x="422" y="28" width="150" height="12"/>
				<box>
					<pen lineWidth="0.0"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["As of: " + new SimpleDateFormat("EEE MMM dd, yyyy hh:mm a").format(new java.util.Date())]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" evaluationTime="Auto">
				<reportElement positionType="Float" x="492" y="40" width="80" height="12"/>
				<box>
					<pen lineWidth="0.0"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page " + ($V{CURRENT_PAGE_NUMBER} == null ? $V{PAGE_NUMBER}:$V{CURRENT_PAGE_NUMBER}) + " of " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="25" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="220" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Documents]]></text>
			</staticText>
			<staticText>
				<reportElement x="220" y="0" width="35" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Copies]]></text>
			</staticText>
			<staticText>
				<reportElement x="255" y="0" width="50" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Date
Submitted]]></text>
			</staticText>
			<staticText>
				<reportElement x="305" y="0" width="167" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Received By]]></text>
			</staticText>
			<staticText>
				<reportElement x="472" y="0" width="50" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Release]]></text>
			</staticText>
			<staticText>
				<reportElement x="522" y="0" width="50" height="25"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Return]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="0" y="0" width="220" height="15"/>
				<box leftPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{doc_desc}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="220" y="0" width="35" height="15"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{no_copies}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="255" y="0" width="50" height="15"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{date_submitted}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="305" y="0" width="167" height="15"/>
				<box leftPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{received_from}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="472" y="0" width="50" height="15"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{docs_out}]]></textFieldExpression>
			</textField>
			<textField pattern="MM/dd/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="522" y="0" width="50" height="15"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{docs_in}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="15" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="220" height="15"/>
				<textElement verticalAlignment="Middle" markup="styled">
					<font fontName="Tahoma" size="7"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[msg("<font face=\"Dot Font\">{0}</font>/{1}", $F{company_alias}, $P{prepared_by}.toUpperCase())]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
