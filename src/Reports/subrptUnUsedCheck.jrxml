<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="subrptUnUsedCheck" printOrder="Horizontal" pageWidth="270" pageHeight="290" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="270" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="1.652892561983471"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="date_from" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="date_to" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="bank" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="bank_branch" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="bank_account" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select (case when a.last_no_used is null or a.last_no_used = '' then trim(a.from_check_no) else
( repeat('0', length(max(a.from_check_no))  -
length((max(case when trim(a.last_no_used) = '' then 0 else   trim(a.last_no_used)::double precision end)+1)::text) ) ||
max(case when trim(a.last_no_used) = '' then 0 else   trim(a.last_no_used)::double precision end) +1 )
end) AS from_, a.to_check_no AS to_, get_client_name(b.entity_id) AS issued_to_
from rf_check_book a
LEFT JOIN em_employee b on a.user_id = b.emp_code
left join mf_bank_account c on a.bank_acct_id = c.bank_acct_id
left join mf_bank_branch d on c.bank_branch_id = d.bank_branch_id
left join mf_bank e on d.bank_id = e.bank_id

where a.status_id = 'A'
AND (CASE WHEN ($P{bank} = 'All' OR NULLIF(UPPER($P{bank}), 'NULL') IS NULL) THEN TRUE ELSE e.bank_name ~* $P{bank} END)
AND (CASE WHEN ($P{bank_branch} = 'All' OR NULLIF(UPPER($P{bank_branch}), 'NULL') IS NULL) THEN TRUE ELSE d.bank_branch_location ~* $P{bank_branch} END)
AND (CASE WHEN ($P{bank_account} = 'All' OR NULLIF(UPPER($P{bank_account}), 'NULL') IS NULL) THEN TRUE ELSE c.bank_acct_no ~* $P{bank_account} END)
and a.last_no_used < a.to_check_no
group by a.last_no_used, a.from_check_no, a.rec_id, a.to_check_no, a.user_id, b.entity_id
order by from_ DESC;]]>
	</queryString>
	<field name="from_" class="java.lang.String"/>
	<field name="to_" class="java.lang.String"/>
	<field name="issued_to_" class="java.lang.String"/>
	<variable name="Total" class="java.math.BigDecimal" resetType="Column" calculation="Sum">
		<variableExpression><![CDATA[]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<columnHeader>
		<band height="26">
			<staticText>
				<reportElement x="40" y="1" width="79" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Tahoma" size="8" isBold="true" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[SERIES]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="13" width="79" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Tahoma" size="8" isBold="true" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[FROM]]></text>
			</staticText>
			<staticText>
				<reportElement x="79" y="13" width="79" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Tahoma" size="8" isBold="true" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[TO]]></text>
			</staticText>
			<staticText>
				<reportElement x="157" y="13" width="113" height="13"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" markup="none">
					<font fontName="Tahoma" size="8" isBold="true" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[ISSUED TO]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="0" y="0" width="79" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isStrikeThrough="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{from_}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="79" y="0" width="79" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isStrikeThrough="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{to_}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="157" y="0" width="113" height="13"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isStrikeThrough="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{issued_to_}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
