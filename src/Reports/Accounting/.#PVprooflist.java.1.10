package Reports.Accounting;

import interfaces._GUI;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyEvent;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.border.Border;
import javax.swing.border.EmptyBorder;
import javax.swing.event.AncestorEvent;
import javax.swing.event.AncestorListener;
import org.jdesktop.swingx.JXTextField;
import Accounting.Disbursements.RequestForPayment;
import DateChooser._JDateChooser;
import Functions.FncFocusTraversalPolicy;
import Functions.FncGlobal;
import Functions.FncReport;
import Functions.UserInfo;
import Lookup.LookupEvent;
import Lookup.LookupListener;
import Lookup._JLookup;
import components._JInternalFrame;
import components._JTagLabel;

public class PVprooflist extends _JInternalFrame implements ActionListener, AncestorListener, _GUI {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1162406788303915011L;

	static String title = "PV Prooflist";
	static Dimension frameSize = new Dimension(700, 580);
	static Border lineBorder = BorderFactory.createLineBorder(Color.GRAY);
	static Cursor handCursor = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);

	private JPanel pnlMain;
	private JPanel pnlNorth;
	private JPanel pnlNorthWest;
	private JPanel pnlCenter;
	private JPanel pnlNorthEast;
	private JPanel pnlNorth_comp;
	private JPanel pnlDRFDtl_2a;
	private JPanel pnlDRFDtl_2b;
	private JPanel pnlDRF;
	private JPanel pnlCreatedBy;
	private JPanel pnlCenterDRF;
	private JPanel pnlCenterCreated;
	private JPanel pnlCenter_a;
	private JPanel pnlCenter_2;
	private JPanel pnlSouth;

	private JLabel lblCompany;
	private JLabel lblDateFrom;
	private JLabel lblDateTo;
	private JLabel lblDateRequest;
	private JLabel lblPVFrom;
	private JLabel lblPVTo;
	private JLabel lblPayee;
	private JLabel lblAvailer;
	private JLabel lblPVStatus;
	private JLabel lblStatus;
	private JLabel lblPaymentType;	
	
	private _JTagLabel tagReqType;
	private _JTagLabel tagPayee1;
	private _JTagLabel tagPayee2;
	private _JTagLabel tagStatus;
	private _JTagLabel tagPreparedBy;
	private _JTagLabel tagPmtType;

	private _JLookup lookupProject;
	private _JLookup lookupCompany;
	private _JLookup lookupRequestType;
	private _JLookup lookupPayee1;
	private _JLookup lookupPayee2;
	private _JLookup lookupStatus;
	private _JLookup lookupPreparedby;
	private _JLookup lookupPmtType;
	
	private JTextField txtCompany;
	private JXTextField txtPVfrom;		
	private JXTextField txtPVto;	
	
	private JButton btnPreview;
	private JButton btnCancel;

	String company;
	private String company_logo;		

	private _JDateChooser dteDateFrom;
	private _JDateChooser dateDateTo;	
	SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-mm-dd");
	
	String req_type_id 		= "";
	String req_type_name		= "";
	String payee_id 			= "";
	String payee_name		= "";
	String availer_id 		= "";
	String availer_name 		= "";
	String prepared_by_id	= "";
	String prepared_by_name	= "";
	String status_id			= "";
	String status_name		= "";
	String pmt_type_id		= "";
	String pmt_type_name		= "";
	String co_id = "";

	private JCheckBox chkPVwithoutDV;
	private JButton btnPrevByBatch;
	private static PVProoflistByBatch pnlPVBatch; 

	
	public PVprooflist() {
		super(title, true, true, true, true);
		initGUI();
	}

	private PVprooflist(String title) {
		super(title);
		initGUI();
	}

	private PVprooflist(String title, boolean resizable, boolean closable, boolean maximizable, boolean iconifiable) {
		super(title, resizable, closable, maximizable, iconifiable);
		initGUI();
	}

	@Override
//	public void initGUI() {
//		this.setTitle(title);
//		this.setSize(frameSize);
//		this.setPreferredSize(new java.awt.Dimension(624, 473));
//		this.setLayout(new BorderLayout());
//		this.addAncestorListener(this);
//		{
//			pnlMain = new JPanel(new BorderLayout(5, 5));
//			getContentPane().add(pnlMain, BorderLayout.WEST);
//			pnlMain.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
//			pnlMain.setPreferredSize(new java.awt.Dimension(621, 462));
//			
//			{
//				pnlNorth = new JPanel(new BorderLayout(5, 5));
//				pnlMain.add(pnlNorth, BorderLayout.NORTH);
//				pnlNorth.setPreferredSize(new java.awt.Dimension(547, 193));
//
//				{
//					pnlNorth_comp = new JPanel(new BorderLayout(5, 5));
//					pnlNorth.add(pnlNorth_comp, BorderLayout.NORTH);
//					pnlNorth_comp.setPreferredSize(new java.awt.Dimension(547, 63));
//					pnlNorth_comp.setBorder(components.JTBorderFactory.createTitleBorder("Company"));// XXX
//
//					{
//						pnlNorthWest = new JPanel(new GridLayout(1,1, 5, 5));
//						pnlNorth_comp.add(pnlNorthWest, BorderLayout.WEST);
//						pnlNorthWest.setPreferredSize(new java.awt.Dimension(142, 100));
//						{
//							lblCompany = new JLabel("Company", JLabel.TRAILING);
//							pnlNorthWest.add(lblCompany);
//						}
//						{
//							lookupCompany = new _JLookup(null, "Company");
//							pnlNorthWest.add(lookupCompany);
//							lookupCompany.setReturnColumn(0);
//							lookupCompany.setLookupSQL(SummaryofDeposits.company());
//							lookupCompany.addLookupListener(new LookupListener() {
//								public void lookupPerformed(LookupEvent event) {
//									Object[] data = ((_JLookup)event.getSource()).getDataSet();
//									if(data != null){
//
//										co_id = (String) data[0];
//										company = (String) data[1];
//										company_logo = (String) data[3];
//
//										String name = (String) data[1];						
//										txtCompany.setText(name);
//
//										enabledFields(true);
//										lookupRequestType.setLookupSQL(getRequestType());	
//										lookupPayee1.setLookupSQL(getPayee());	
//										lookupPayee2.setLookupSQL(getAvailer());	
//										lookupPreparedby.setLookupSQL(getPreparedBy());	
//										lookupPmtType.setLookupSQL(getPayment_type());	
//										lookupStatus.setLookupSQL(getStatus());	
//									}
//								}
//							});
//						}
//					}
//					pnlNorthEast = new JPanel(new GridLayout(1, 1, 5, 5));
//					pnlNorth_comp.add(pnlNorthEast, BorderLayout.CENTER);
//					pnlNorthEast.setPreferredSize(new java.awt.Dimension(300, 159));
//					{
//						txtCompany = new JTextField();
//						pnlNorthEast.add(txtCompany, BorderLayout.CENTER);
//						txtCompany.setEditable(false);
//					}
//				}
//				{
//					pnlCenterDRF = new JPanel(new GridLayout(1,1,5, 5));
//					pnlNorth.add(pnlCenterDRF, BorderLayout.CENTER);
//					pnlCenterDRF.setPreferredSize(new java.awt.Dimension(499, 60));
//					pnlCenterDRF.setBorder(components.JTBorderFactory.createTitleBorder("DRF No."));
//					
//					{
//						pnlDRF = new JPanel(new GridLayout(1, 2, 3, 3));
//						pnlCenterDRF.add(pnlDRF, BorderLayout.WEST);					
//
//						{
//							lblPVFrom = new JLabel("PV From   ", JLabel.TRAILING);
//							pnlDRF.add(lblPVFrom, BorderLayout.CENTER);
//							lblPVFrom.setEnabled(false);							
//						}
//						{
//							txtPVfrom = new JXTextField("");
//							pnlDRF.add(txtPVfrom);
//							txtPVfrom.setEnabled(false);	
//							txtPVfrom.setEditable(true);
//							txtPVfrom.setBounds(120, 25, 300, 22);	
//							txtPVfrom.setHorizontalAlignment(JTextField.CENTER);
//							txtPVfrom.setFont(new java.awt.Font("Segoe UI",Font.BOLD,12));
//						}	
//						{	
//
//							lblPVTo = new JLabel("PV To   ", JLabel.TRAILING);
//							pnlDRF.add(lblPVTo);
//							lblPVTo.setEnabled(false);	
//						}					
//						{
//							txtPVto = new JXTextField("");
//							pnlDRF.add(txtPVto);
//							txtPVto.setEnabled(false);	
//							txtPVto.setEditable(true);
//							txtPVto.setBounds(120, 25, 300, 22);	
//							txtPVto.setHorizontalAlignment(JTextField.CENTER);
//							txtPVto.setFont(new java.awt.Font("Segoe UI",Font.BOLD,12));
//						}
//					}
//				}
//				{
//					pnlCenterCreated = new JPanel(new GridLayout(1,1,5, 5));
//					pnlNorth.add(pnlCenterCreated, BorderLayout.SOUTH);
//					pnlCenterCreated.setPreferredSize(new java.awt.Dimension(547, 59));
//					pnlCenterCreated.setBorder(components.JTBorderFactory.createTitleBorder("Created Date"));
//					
//					{
//						pnlCreatedBy = new JPanel(new GridLayout(1, 2, 3, 3));
//						pnlCenterCreated.add(pnlCreatedBy, BorderLayout.WEST);					
//
//						{
//							lblDateFrom = new JLabel("Date From   ", JLabel.TRAILING);
//							pnlCreatedBy.add(lblDateFrom, BorderLayout.CENTER);
//							lblDateFrom.setEnabled(false);							
//						}
//						{
//							dteDateFrom = new _JDateChooser("MM/dd/yyyy", "##/##/##", '_');
//							pnlCreatedBy.add(dteDateFrom, BorderLayout.CENTER);						
//							dteDateFrom.setDate(null);
//							dteDateFrom.setEnabled(false);
//							dteDateFrom.setDate(null);
//						}	
//						{	
//
//							lblDateTo = new JLabel("Date To   ", JLabel.TRAILING);
//							pnlCreatedBy.add(lblDateTo);
//							lblDateTo.setEnabled(false);	
//						}					
//						{
//							dateDateTo = new _JDateChooser("MM/dd/yyyy", "##/##/##", '_');
//							pnlCreatedBy.add(dateDateTo, BorderLayout.EAST);
//							dateDateTo.setBounds(485, 7, 125, 21);
//							dateDateTo.setDate(null);
//							dateDateTo.setEnabled(false);
//							dateDateTo.setDate(null);
//						}
//					}
//				}
//
//			}	
//			{
//				pnlCenter =  new JPanel(new BorderLayout(5, 5));
//				pnlMain.add(pnlCenter, BorderLayout.CENTER);
//				pnlCenter.setPreferredSize(new java.awt.Dimension(499, 50));
//				pnlCenter.setBorder(components.JTBorderFactory.createTitleBorder("Search Options"));
//				
//				{		
//					pnlCenter_a = new JPanel(new GridLayout(6, 1, 0, 5));
//					pnlCenter.add(pnlCenter_a, BorderLayout.WEST);	
//					pnlCenter_a.setPreferredSize(new java.awt.Dimension(95, 185));
//					
//					{
//						lblDateRequest = new JLabel("Request Type", JLabel.TRAILING);
//						pnlCenter_a.add(lblDateRequest);
//						lblDateRequest.setEnabled(false);	
//					}	
//					{
//						lblPayee = new JLabel("Payee", JLabel.TRAILING);
//						pnlCenter_a.add(lblPayee);
//						lblPayee.setEnabled(false);	
//					}	
//					{
//						lblAvailer= new JLabel("Availer", JLabel.TRAILING);
//						pnlCenter_a.add(lblAvailer);
//						lblAvailer.setEnabled(false);	
//					}	
//					{
//						lblStatus = new JLabel("Prepared by", JLabel.TRAILING);
//						pnlCenter_a.add(lblStatus);
//						lblStatus.setEnabled(false);	
//					}
//					{
//						lblPVStatus = new JLabel("PV Status", JLabel.TRAILING);
//						pnlCenter_a.add(lblPVStatus);
//						lblPVStatus.setEnabled(false);	
//					}
//					{
//						lblPaymentType = new JLabel("Pmt. Type", JLabel.TRAILING);
//						pnlCenter_a.add(lblPaymentType);
//						lblPaymentType.setEnabled(false);	
//					}					
//
//					pnlCenter_2 = new JPanel(new BorderLayout(5,0));
//					pnlCenter.add(pnlCenter_2, BorderLayout.CENTER);
//					pnlCenter_2.setPreferredSize(new java.awt.Dimension(203, 118));
//					pnlCenter_2.setBorder(BorderFactory.createEmptyBorder(0,5,0,0));
//
//					pnlDRFDtl_2a = new JPanel(new GridLayout(6, 1, 0, 5));
//					pnlCenter_2.add(pnlDRFDtl_2a, BorderLayout.WEST);
//					pnlDRFDtl_2a.setPreferredSize(new java.awt.Dimension(100, 185));
//					pnlDRFDtl_2a.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 0));
//
//					{
//						lookupRequestType = new _JLookup(null, "Request Type", 2, 2);
//						pnlDRFDtl_2a.add(lookupRequestType);
//						lookupRequestType.setBounds(20, 27, 20, 25);
//						lookupRequestType.setReturnColumn(0);
//						lookupRequestType.setFilterName(true);
//						lookupRequestType.setEnabled(false);
//						//lookupRequestType.setEditable(false);
//						lookupRequestType.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupRequestType.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){		
//									req_type_id 	= (String) data[0];		
//									req_type_name 	= (String) data[1];			
//									tagReqType.setTag(req_type_name);
//								}
//							}
//						});	
//					}		
//					{
//						lookupPayee1 = new _JLookup(null, "Payee", 2, 2);
//						pnlDRFDtl_2a.add(lookupPayee1);
//						lookupPayee1.setBounds(20, 27, 20, 25);
//						lookupPayee1.setReturnColumn(0);
//						lookupPayee1.setFilterName(true);
//						lookupPayee1.setEnabled(false);	
//						//lookupPayee1.setEditable(false);
//						lookupPayee1.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupPayee1.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){	
//									payee_id 	= (String) data[0];		
//									payee_name 	= (String) data[1];			
//									tagPayee1.setTag(payee_name);
//								}
//							}
//						});	
//					}		
//					{
//						lookupPayee2 = new _JLookup(null, "Availer", 2, 2);
//						pnlDRFDtl_2a.add(lookupPayee2);
//						lookupPayee2.setBounds(20, 27, 20, 25);
//						lookupPayee2.setReturnColumn(0);
//						lookupPayee2.setFilterName(true);
//						lookupPayee2.setEnabled(false);	
//						//lookupPayee2.setEditable(false);
//						lookupPayee2.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupPayee2.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){						
//									availer_id 		= (String) data[0];		
//									availer_name 	= (String) data[1];			
//									tagPayee2.setTag(availer_name);
//								}
//							}
//						});	
//					}		
//					
//					{
//						lookupPreparedby = new _JLookup(null, "DRF Status", 2, 2);
//						pnlDRFDtl_2a.add(lookupPreparedby);
//						lookupPreparedby.setBounds(20, 27, 20, 25);
//						lookupPreparedby.setReturnColumn(0);
//						lookupPreparedby.setFilterName(true);
//						lookupPreparedby.setEnabled(false);	
//						//lookupPreparedby.setEditable(false);
//						lookupPreparedby.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupPreparedby.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){		
//									prepared_by_id 		= (String) data[0];		
//									prepared_by_name 	= (String) data[1];			
//									tagPreparedBy.setTag(prepared_by_name);	
//								}
//							}
//						});	
//					}	
//
//					{
//						lookupStatus = new _JLookup(null, "Prepared by", 2, 2);
//						pnlDRFDtl_2a.add(lookupStatus);
//						lookupStatus.setBounds(20, 27, 20, 25);
//						lookupStatus.setReturnColumn(0);
//						lookupStatus.setFilterName(true);
//						lookupStatus.setEnabled(false);	
//						//lookupStatus.setEditable(false);
//						lookupStatus.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupStatus.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){		
//									status_id 		= (String) data[0];		
//									status_name 	= (String) data[1];			
//									tagStatus.setTag(status_name);	
//								}
//							}
//						});	
//					}	
//					{
//						lookupPmtType = new _JLookup(null, "Office Branch", 2, 2);
//						pnlDRFDtl_2a.add(lookupPmtType);
//						lookupPmtType.setBounds(20, 27, 20, 25);
//						lookupPmtType.setReturnColumn(0);
//						lookupPmtType.setFilterName(true);
//						lookupPmtType.setEnabled(false);	
//						//lookupPmtType.setEditable(false);
//						lookupPmtType.setPreferredSize(new java.awt.Dimension(157, 22));
//						lookupPmtType.addLookupListener(new LookupListener() {
//							public void lookupPerformed(LookupEvent event) {
//								Object[] data = ((_JLookup)event.getSource()).getDataSet();
//								if(data != null){		
//									pmt_type_id 	= (String) data[0];		
//									pmt_type_name 	= (String) data[1];			
//									tagPmtType.setTag(pmt_type_name);	
//								}
//							}
//						});	
//					}		
//
//					pnlDRFDtl_2b = new JPanel(new GridLayout(6, 1, 0, 5));
//					pnlCenter_2.add(pnlDRFDtl_2b, BorderLayout.CENTER);
//					pnlDRFDtl_2b.setPreferredSize(new java.awt.Dimension(140, 118));
//					pnlDRFDtl_2b.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 0));
//
//					{
//						tagReqType = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagReqType);
//						tagReqType.setBounds(209, 27, 700, 22);
//						tagReqType.setEnabled(false);	
//						tagReqType.setPreferredSize(new java.awt.Dimension(27, 33));
//					}	
//					{
//						tagPayee1 = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagPayee1);
//						tagPayee1.setBounds(209, 27, 700, 22);
//						tagPayee1.setEnabled(false);	
//						tagPayee1.setPreferredSize(new java.awt.Dimension(27, 33));
//					}		
//					{
//						tagPayee2 = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagPayee2);
//						tagPayee2.setBounds(209, 27, 700, 22);
//						tagPayee2.setEnabled(false);	
//						tagPayee2.setPreferredSize(new java.awt.Dimension(27, 33));
//					}						
//					{
//						tagPreparedBy = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagPreparedBy);
//						tagPreparedBy.setBounds(209, 27, 700, 22);
//						tagPreparedBy.setEnabled(false);	
//						tagPreparedBy.setPreferredSize(new java.awt.Dimension(27, 33));
//					}	
//					{
//						tagStatus = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagStatus);
//						tagStatus.setBounds(209, 27, 700, 22);
//						tagStatus.setEnabled(false);	
//						tagStatus.setPreferredSize(new java.awt.Dimension(27, 33));
//					}	
//					{
//						tagPmtType = new _JTagLabel("[ ]");
//						pnlDRFDtl_2b.add(tagPmtType);
//						tagPmtType.setBounds(209, 27, 700, 22);
//						tagPmtType.setEnabled(false);	
//						tagPmtType.setPreferredSize(new java.awt.Dimension(27, 33));
//					}	
//				}
//			}
//
//			{				
//				pnlSouth = new JPanel(new GridLayout(1, 2,5, 5));
//				pnlMain.add(pnlSouth, BorderLayout.SOUTH);
//				pnlSouth.setPreferredSize(new Dimension(300, 30));
//				{
//					btnPreview = new JButton("Preview");
//					pnlSouth.add(btnPreview);
//					btnPreview.setAlignmentX(0.5f);
//					btnPreview.setEnabled(false);
//					btnPreview.setAlignmentY(0.5f);
//					btnPreview.setMaximumSize(new Dimension(100, 30));
//					btnPreview.setMnemonic(KeyEvent.VK_P);
//					btnPreview.addActionListener(this);
//				}
//				{
//					btnCancel = new JButton("Cancel");
//					pnlSouth.add(btnCancel);
//					btnCancel.setAlignmentX(0.5f);
//					btnCancel.setAlignmentY(0.5f);
//					btnCancel.setMaximumSize(new Dimension(100, 30));
//					btnCancel.setMnemonic(KeyEvent.VK_P);
//					btnCancel.setEnabled(false);
//					btnCancel.addActionListener(this);
//				}
//			}
//		}
//		
//		this.setFocusTraversalPolicy(new FncFocusTraversalPolicy(lookupCompany, lookupProject,  
//				dteDateFrom, dateDateTo, btnPreview));
//		this.setBounds(0, 0, 624, 473);  //174
//		
//		//added 01/26/2016 - purpose - set CENQHOMES as default company
//		initialize_comp();
//	}
	
	public void initGUI() {
		this.setLayout(new BorderLayout(5,5));
		this.setSize(frameSize);
		this.setMinimumSize(frameSize);
		{
			pnlMain = new JPanel(new BorderLayout(5,5));
			this.add(pnlMain, BorderLayout.CENTER);
			pnlMain.setBorder(new EmptyBorder(5, 5, 5, 5));
//			{
//				pnlBatch = new JPanel(new BorderLayout(5,5));
//				pnlBatch.setPreferredSize(new Dimension(700,400));
//				{
//					JPanel pnlBatchCenter = new JPanel(new BorderLayout(5,5));
//					pnlBatch.add(pnlBatchCenter, BorderLayout.CENTER);
//					{
//						scrollPVBatch = new JScrollPane();
//						pnlBatch.add(scrollPVBatch);
//						scrollPVBatch.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
//						{
//							modelPVBatch = new modelPVProoflistBatch();
//							tblPVBatch = new _JTableMain(modelPVBatch);
//							
//							scrollPVBatch.setViewportView(tblPVBatch);
//							tblPVBatch.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
//							tblPVBatch.setFont(FncGlobal.sizeTextValue);
//						}
//						{ 
//							rowHeaderPVBatch = tblPVBatch.getRowHeader(); 
//							rowHeaderPVBatch.setModel(new DefaultListModel()); 
//							scrollPVBatch.setRowHeaderView(rowHeaderPVBatch);
//							scrollPVBatch.setCorner(ScrollPaneConstants.UPPER_LEFT_CORNER,FncTables.getRowHeader_Header()); 
//						}
//					}
//				}
//				{
//					JPanel pnlBatchSouth = new JPanel(new GridLayout(1,2,5,5));
//					pnlBatch.add(pnlBatchSouth, BorderLayout.SOUTH);
//					pnlBatchSouth.setPreferredSize(new Dimension(0,30));
//					{
//						btnPrevBatch = new JButton("Preview");
//						pnlBatchSouth.add(btnPrevBatch);
//						btnPrevBatch.addActionListener(this);
//						btnPrevBatch.setActionCommand("Show Batch");
//						btnPrevBatch.setFont(FncGlobal.sizeControls);
//					}
//					{
//						btnCancelBatch = new JButton("Cancel");
//						pnlBatchSouth.add(btnCancelBatch);
//						btnCancelBatch.addActionListener(this);
//						btnCancelBatch.setActionCommand("Close Batch");
//						btnCancelBatch.setFont(FncGlobal.sizeControls);
//					}
//				}
//			}
			{
				pnlCenter = new JPanel(new GridBagLayout());
				pnlMain.add(pnlCenter, BorderLayout.CENTER);
				{
					GridBagConstraints c = new GridBagConstraints();
					c.fill = GridBagConstraints.BOTH;
					{
						c.weightx = 1;
						c.weighty = 0.25;

						c.gridx = 0; 
						c.gridy = 0; 
						
						JPanel pnlCompany = new JPanel(new GridBagLayout());
						pnlCenter.add(pnlCompany, c);
						pnlCompany.setBorder(components.JTBorderFactory.createTitleBorder("Company" ));// XXX
						{
							GridBagConstraints cons_com = new GridBagConstraints();
							cons_com.fill = GridBagConstraints.BOTH;
							cons_com.insets = new Insets(5, 5, 5, 5);
							
							{
								cons_com.weightx = 0;
								cons_com.weighty = 1;

								cons_com.gridx = 0; 
								cons_com.gridy = 0;
								
								lblCompany = new JLabel("Company", JLabel.CENTER);
								pnlCompany.add(lblCompany, cons_com);
								lblCompany.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_com.weightx = 0.25;
								cons_com.weighty = 1;

								cons_com.gridx = 1; 
								cons_com.gridy = 0; 
								
								lookupCompany = new _JLookup(null, "Company");
								pnlCompany.add(lookupCompany, cons_com);
								lookupCompany.setReturnColumn(0);
								lookupCompany.setLookupSQL(SummaryofDeposits.company());
								lookupCompany.setFont(FncGlobal.sizeTextValue);
								lookupCompany.setPreferredSize(new Dimension(60,0));
								lookupCompany.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){

											co_id = (String) data[0];
											company = (String) data[1];
											company_logo = (String) data[3];

											String name = (String) data[1];						
											txtCompany.setText(name);

											enabledFields(true);
											lookupRequestType.setLookupSQL(getRequestType());	
											lookupPayee1.setLookupSQL(getPayee());	
											lookupPayee2.setLookupSQL(getAvailer());	
											lookupPreparedby.setLookupSQL(getPreparedBy());	
											lookupPmtType.setLookupSQL(getPayment_type());	
											lookupStatus.setLookupSQL(getStatus());	
										}
									}
								});				
							}
							{
								cons_com.weightx = 1.5;
								cons_com.weighty = 1;

								cons_com.gridx = 2; 
								cons_com.gridy = 0; 
								
								txtCompany = new JTextField();
								pnlCompany.add(txtCompany, cons_com);
								txtCompany.setEditable(false);
								txtCompany.setFont(FncGlobal.sizeTextValue);
							}
						}
					}
					{
						c.weightx = 1;
						c.weighty = 0.25;

						c.gridx = 0; 
						c.gridy = 1;
						
						JPanel pnlDRF = new JPanel(new GridBagLayout());
						pnlCenter.add(pnlDRF, c);
						pnlDRF.setBorder(components.JTBorderFactory.createTitleBorder("DRF No."));
						{
							GridBagConstraints cons_drfno = new GridBagConstraints();
							cons_drfno.fill = GridBagConstraints.BOTH;
							cons_drfno.insets = new Insets(5, 5, 5, 5);
							
							{
								cons_drfno.weightx = 0.5;
								cons_drfno.weighty = 1;

								cons_drfno.gridx = 0; 
								cons_drfno.gridy = 0;
								
								lblPVFrom = new JLabel("PV From", JLabel.CENTER);
								pnlDRF.add(lblPVFrom, cons_drfno);
								lblPVFrom.setEnabled(false);
								lblPVFrom.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_drfno.weightx = 1;
								cons_drfno.weighty = 1;

								cons_drfno.gridx = 1; 
								cons_drfno.gridy = 0; 
								
								txtPVfrom = new JXTextField("");
								pnlDRF.add(txtPVfrom, cons_drfno);
								txtPVfrom.setEnabled(false);	
								txtPVfrom.setEditable(true);
								txtPVfrom.setHorizontalAlignment(JTextField.CENTER);
								txtPVfrom.setFont(FncGlobal.sizeTextValue);
							}
							{
								cons_drfno.weightx = 0.5;
								cons_drfno.weighty = 1;

								cons_drfno.gridx = 2; 
								cons_drfno.gridy = 0;
								
								lblPVTo = new JLabel("PV To", JLabel.CENTER);
								pnlDRF.add(lblPVTo, cons_drfno);
								lblPVTo.setEnabled(false);
								lblPVTo.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_drfno.weightx = 1;
								cons_drfno.weighty = 1;

								cons_drfno.gridx = 3; 
								cons_drfno.gridy = 0;
								
								txtPVto = new JXTextField("");
								pnlDRF.add(txtPVto, cons_drfno);
								txtPVto.setEnabled(false);	
								txtPVto.setEditable(true);
								txtPVto.setHorizontalAlignment(JTextField.CENTER);
								txtPVto.setFont(FncGlobal.sizeTextValue);
							}
						}
					}
					{
						c.weightx = 1;
						c.weighty = 0.25;

						c.gridx = 0; 
						c.gridy = 2;
						
						JPanel pnlCreate = new JPanel(new GridBagLayout());
						pnlCenter.add(pnlCreate, c);
						pnlCreate.setBorder(components.JTBorderFactory.createTitleBorder("Created Date"));
						{
							GridBagConstraints cons_dtecreated = new GridBagConstraints();
							cons_dtecreated.fill = GridBagConstraints.BOTH;
							cons_dtecreated.insets = new Insets(5, 5, 5, 5);
							
							{
								cons_dtecreated.weightx = 0.5;
								cons_dtecreated.weighty = 1;

								cons_dtecreated.gridx = 0; 
								cons_dtecreated.gridy = 0; 
								
								lblDateFrom = new JLabel("Date From", JLabel.CENTER);
								pnlCreate.add(lblDateFrom, cons_dtecreated);
								lblDateFrom.setEnabled(false);
								lblDateFrom.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_dtecreated.weightx = 1;
								cons_dtecreated.weighty = 1;

								cons_dtecreated.gridx = 1; 
								cons_dtecreated.gridy = 0; 
								
								dteDateFrom = new _JDateChooser("MM/dd/yyyy", "##/##/##", '_');
								pnlCreate.add(dteDateFrom, cons_dtecreated);						
								dteDateFrom.setDate(null);
								dteDateFrom.setEnabled(false);
								dteDateFrom.setFont(FncGlobal.sizeTextValue);
							}
							{
								cons_dtecreated.weightx = 0.5;
								cons_dtecreated.weighty = 1;

								cons_dtecreated.gridx = 2; 
								cons_dtecreated.gridy = 0; 
								
								lblDateTo = new JLabel("Date To", JLabel.CENTER);
								pnlCreate.add(lblDateTo, cons_dtecreated);
								lblDateTo.setEnabled(false);
								lblDateTo.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_dtecreated.weightx = 1;
								cons_dtecreated.weighty = 1;

								cons_dtecreated.gridx = 3; 
								cons_dtecreated.gridy = 0;
								
								dateDateTo = new _JDateChooser("MM/dd/yyyy", "##/##/##", '_');
								pnlCreate.add(dateDateTo, cons_dtecreated);
								dateDateTo.setDate(null);
								dateDateTo.setEnabled(false);
								dateDateTo.setFont(FncGlobal.sizeTextValue);
							}
						}
					}
					{
						c.weightx = 1;
						c.weighty = 1.5;

						c.gridx = 0; 
						c.gridy = 3;
						
						JPanel pnlSearch = new JPanel(new GridBagLayout());
						pnlCenter.add(pnlSearch, c);
						pnlSearch.setBorder(components.JTBorderFactory.createTitleBorder("Search Options"));
						{
							GridBagConstraints cons_searchopt = new GridBagConstraints();
							cons_searchopt.fill = GridBagConstraints.BOTH;
							cons_searchopt.insets = new Insets(5, 5, 5, 5);
							
							/*LINE 1*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 0;
								
								lblDateRequest = new JLabel("Request Type", JLabel.CENTER);
								pnlSearch.add(lblDateRequest, cons_searchopt);
								lblDateRequest.setEnabled(false);
								lblDateRequest.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 0;
								

								lookupRequestType = new _JLookup(null, "Request Type", 2, 2);
								pnlSearch.add(lookupRequestType, cons_searchopt);
								lookupRequestType.setReturnColumn(0);
								lookupRequestType.setFilterName(true);
								lookupRequestType.setEnabled(false);
								lookupRequestType.setFont(FncGlobal.sizeTextValue);
								//lookupRequestType.setEditable(false);
								lookupRequestType.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){		
											req_type_id 	= (String) data[0];		
											req_type_name 	= (String) data[1];			
											tagReqType.setTag(req_type_name);
											
											enableButton(true, false, true);
										}
									}
								});						
							}
							{
								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 0;
								
								tagReqType = new _JTagLabel("[ ]");
								pnlSearch.add(tagReqType, cons_searchopt);
								tagReqType.setEnabled(false);	
								tagReqType.setFont(FncGlobal.sizeTextValue);
							}
							
							/*LINE 2*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 1;
								
								lblPayee = new JLabel("Payee", JLabel.CENTER);
								pnlSearch.add(lblPayee, cons_searchopt);
								lblPayee.setEnabled(false);
								lblPayee.setFont(FncGlobal.sizeLabel);
							}
							{

								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 1;
								
								lookupPayee1 = new _JLookup(null, "Payee", 2, 2);
								pnlSearch.add(lookupPayee1, cons_searchopt);
								lookupPayee1.setReturnColumn(0);
								lookupPayee1.setFilterName(true);
								lookupPayee1.setEnabled(false);	
								lookupPayee1.setFont(FncGlobal.sizeTextValue);
								//lookupPayee1.setEditable(false);
								lookupPayee1.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){	
											payee_id 	= (String) data[0];		
											payee_name 	= (String) data[1];			
											tagPayee1.setTag(payee_name);
											
											enableButton(true, false, true);
										
										}
									}
								});											
							}
							{
								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 1;
								
								tagPayee1 = new _JTagLabel("[ ]");
								pnlSearch.add(tagPayee1, cons_searchopt);
								tagPayee1.setEnabled(false);
								tagPayee1.setFont(FncGlobal.sizeTextValue);
							}
							
							/*LINE 3*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 2;
								
								lblAvailer= new JLabel("Availer", JLabel.CENTER);
								pnlSearch.add(lblAvailer, cons_searchopt);
								lblAvailer.setEnabled(false);	
								lblAvailer.setFont(FncGlobal.sizeLabel);
							}
							{

								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 2;
								

								lookupPayee2 = new _JLookup(null, "Availer", 2, 2);
								pnlSearch.add(lookupPayee2, cons_searchopt);
								lookupPayee2.setReturnColumn(0);
								lookupPayee2.setFilterName(true);
								lookupPayee2.setEnabled(false);	
								lookupPayee2.setFont(FncGlobal.sizeTextValue);
								//lookupPayee2.setEditable(false);
								lookupPayee2.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){						
											availer_id 		= (String) data[0];		
											availer_name 	= (String) data[1];			
											tagPayee2.setTag(availer_name);
											
											enableButton(true, false, true);
										}
									}
								});																
							}
							{
								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 2;

								tagPayee2 = new _JTagLabel("[ ]");
								pnlSearch.add(tagPayee2, cons_searchopt);
								tagPayee2.setEnabled(false);	
								tagPayee2.setFont(FncGlobal.sizeTextValue);
							}
							
							/*LINE 4*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 3;
								
								lblStatus = new JLabel("Prepared by", JLabel.CENTER);
								pnlSearch.add(lblStatus, cons_searchopt);
								lblStatus.setEnabled(false);
								lblStatus.setFont(FncGlobal.sizeLabel);
							}
							{

								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 3;							


								lookupPreparedby = new _JLookup(null, "DRF Status", 2, 2);
								pnlSearch.add(lookupPreparedby, cons_searchopt);
								lookupPreparedby.setReturnColumn(0);
								lookupPreparedby.setFilterName(true);
								lookupPreparedby.setEnabled(false);	
								lookupPreparedby.setFont(FncGlobal.sizeTextValue);
								//lookupPreparedby.setEditable(false);
								lookupPreparedby.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){		
											prepared_by_id 		= (String) data[0];		
											prepared_by_name 	= (String) data[1];			
											tagPreparedBy.setTag(prepared_by_name);
											
											enableButton(true, false, true);
										}
									}
								});					
							}
							{

								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 3;
								
								tagPreparedBy = new _JTagLabel("[ ]");
								pnlSearch.add(tagPreparedBy, cons_searchopt);
								tagPreparedBy.setEnabled(false);	
								tagPreparedBy.setFont(FncGlobal.sizeTextValue);
							}
							
							/*EDITED BY JED 2021-02-15 : CHANGE THE PLACES OF LINE 5 AND LINE 6*/
							/*LINE 5*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 4;
								
								lblPaymentType = new JLabel("Pmt. Type", JLabel.CENTER);
								pnlSearch.add(lblPaymentType, cons_searchopt);
								lblPaymentType.setEnabled(false);		
								lblPaymentType.setFont(FncGlobal.sizeLabel);
														
							}
							{

								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 4;
								
								lookupPmtType = new _JLookup(null, "Office Branch", 2, 2);
								pnlSearch.add(lookupPmtType, cons_searchopt);
								lookupPmtType.setReturnColumn(0);
								lookupPmtType.setFilterName(true);
								lookupPmtType.setEnabled(false);	
								lookupPmtType.setFont(FncGlobal.sizeTextValue);
								//lookupPmtType.setEditable(false);
								lookupPmtType.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){		
											pmt_type_id 	= (String) data[0];		
											pmt_type_name 	= (String) data[1];			
											tagPmtType.setTag(pmt_type_name);	
										}
									}
								});																										
							}					
							{
								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 4;
								
								tagPmtType = new _JTagLabel("[ ]");
								pnlSearch.add(tagPmtType, cons_searchopt);
								tagPmtType.setEnabled(false);	
								tagPmtType.setFont(FncGlobal.sizeTextValue);
							}

							/*LINE 6*/
							{
								cons_searchopt.weightx = 0;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 5;

								lblPVStatus = new JLabel("PV Status", JLabel.CENTER);
								pnlSearch.add(lblPVStatus, cons_searchopt);
								lblPVStatus.setEnabled(false);
								lblPVStatus.setFont(FncGlobal.sizeLabel);
							}
							{
								cons_searchopt.weightx = 0.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 1;
								cons_searchopt.gridy = 5;
								
								lookupStatus = new _JLookup(null, "Prepared by", 2, 2);
								pnlSearch.add(lookupStatus, cons_searchopt);
								lookupStatus.setReturnColumn(0);
								lookupStatus.setFilterName(true);
								lookupStatus.setEnabled(false);	
								lookupStatus.setFont(FncGlobal.sizeTextValue);
								//lookupStatus.setEditable(false);
								lookupStatus.addLookupListener(new LookupListener() {
									public void lookupPerformed(LookupEvent event) {
										Object[] data = ((_JLookup)event.getSource()).getDataSet();
										if(data != null){		
											status_id 		= (String) data[0];		
											status_name 	= (String) data[1];			
											tagStatus.setTag(status_name);
											
											if(status_id.equals("P")) {
												chkPVwithoutDV.setEnabled(true);
												enableButton(true, false, true);
											} 
											else if(status_id.equals("F") && !lookupRequestType.getText().equals("") && !lookupPayee1.getText().equals("") && !lookupPayee2.getText().equals("")){
												chkPVwithoutDV.setEnabled(false);
												chkPVwithoutDV.setSelected(false);
												enableButton(true, true, true);
											}
											else {
												chkPVwithoutDV.setEnabled(false);
												chkPVwithoutDV.setSelected(false);
												enableButton(true, false, true);
											}
										}
									}
								});				
							}
							{
								cons_searchopt.weightx = 1.5;
								cons_searchopt.weighty = 1;
								
								cons_searchopt.gridx = 2;
								cons_searchopt.gridy = 5;

								tagStatus = new _JTagLabel("[ ]");
								pnlSearch.add(tagStatus, cons_searchopt);
								tagStatus.setEnabled(false);	
								tagStatus.setFont(FncGlobal.sizeTextValue);
							}
							
							/*LINE 7*/
							/*ADD BY JED 2020-12-11 : TO VIEW PV WITHOUT DV ONLY(MERGE WITH PV WITHOUT DV MODULE)*/
							{
								cons_searchopt.weightx = 0.25;
								cons_searchopt.weighty = 1;

								cons_searchopt.gridx = 0; 
								cons_searchopt.gridy = 6;
								
								cons_searchopt.gridwidth = 2;
						
								chkPVwithoutDV = new JCheckBox("Show PV without DV only");
								pnlSearch.add(chkPVwithoutDV, cons_searchopt);
								chkPVwithoutDV.setEnabled(false);
								chkPVwithoutDV.setFont(FncGlobal.sizeTextValue);
								chkPVwithoutDV.addItemListener(new ItemListener() {
									public void itemStateChanged(ItemEvent arg0) {
										System.out.println("checkboxlistener");
									}
								});				
							}						
						}			
					}
				}
			}
			{	
				pnlSouth = new JPanel(new GridLayout(1,3,5, 5));
				pnlMain.add(pnlSouth, BorderLayout.SOUTH);
				pnlSouth.setPreferredSize(new Dimension(0, 30));
				{
					btnPreview = new JButton("Preview");
					pnlSouth.add(btnPreview);
					btnPreview.setEnabled(false);
					btnPreview.setMnemonic(KeyEvent.VK_P);
					btnPreview.addActionListener(this);
					btnPreview.setActionCommand("Preview");
					btnPreview.setFont(FncGlobal.sizeControls);
				}
				{/*ADDED BY JED 2021-02-01 DCRF NO. 1562 : PREVIEW PV'S BY BATCH*/
					btnPrevByBatch = new JButton("Preview By Batch");
					pnlSouth.add(btnPrevByBatch);
					btnPrevByBatch.setEnabled(false);
					btnPrevByBatch.setMnemonic(KeyEvent.VK_B);
					btnPrevByBatch.addActionListener(this);
					btnPrevByBatch.setActionCommand("Preview By Batch");
					btnPrevByBatch.setFont(FncGlobal.sizeControls);
				}
				{
					btnCancel = new JButton("Cancel");
					pnlSouth.add(btnCancel);
					btnCancel.setMnemonic(KeyEvent.VK_C);
					btnCancel.setEnabled(false);
					btnCancel.addActionListener(this);
					btnCancel.setActionCommand("Cancel");
					btnCancel.setFont(FncGlobal.sizeControls);
				}
			}
		}
		
		this.setFocusTraversalPolicy(new FncFocusTraversalPolicy(lookupCompany, lookupProject,  
				dteDateFrom, dateDateTo, btnPreview));
		//this.setBounds(0, 0, 624, 473);  //174

		//added 01/26/2016 - purpose - set CENQHOMES as default company
		initialize_comp();
		
	}
		
	@Override
	public void ancestorAdded(AncestorEvent event) {
		
	}

	@Override
	public void ancestorMoved(AncestorEvent event) { }

	@Override
	public void ancestorRemoved(AncestorEvent event) { }

	@Override
	public void actionPerformed(ActionEvent e) {
		/*EDITED BY JED 2020-12-11 : ADDTIONAL PREVIEW FOR PV WITHOUT DV*/
		req_type_id 	= lookupRequestType.getText().trim();
		payee_id 		= lookupPayee1.getText().trim();
		availer_id 		= lookupPayee2.getText().trim();
		prepared_by_id 	= lookupPreparedby.getText().trim();
		status_id 		= lookupStatus.getText().trim();
		
		Integer pv_fr = 0;
		Integer pv_to = 0;
		
		Date date_fr = null;
		Date date_to = null;
		
		try {date_fr = dateFormat.parse("2000-01-01 00:00:00");} catch (ParseException e1) {e1.printStackTrace();}
		try {date_to = dateFormat.parse("2100-01-01 00:00:00");} catch (ParseException e1) {e1.printStackTrace();}
		
		if (txtPVfrom.getText().equals("")) { } else { pv_fr = Integer.parseInt(txtPVfrom.getText()); }
		if (txtPVto.getText().equals("")) { } else { pv_to = Integer.parseInt(txtPVto.getText()); }
		if (dteDateFrom.getDate()==null) { } else { date_fr = dteDateFrom.getDate(); }
		if (dateDateTo.getDate()==null) { } else { date_to = dateDateTo.getDate(); }
		
		System.out.printf("DRF Fr.: " + txtPVfrom.getText() + "\n");
		System.out.printf("DRF To.: " + txtPVto.getText() + "\n");
			
		if(req_type_id.equals("")) { req_type_name = "All"; } else { }
		if(payee_id.equals("")) { payee_name = "All"; } else { }
		if(availer_id.equals("")) { availer_name = "All"; } else { }
		if(prepared_by_id.equals("")) { prepared_by_name = "All"; } else { }
		if(status_id.equals("")) { status_name = "All"; } else { }
		
		if(e.getActionCommand().equals("Preview")){
			if(chkPVwithoutDV.isSelected()) {
				String criteria = "PV Without DV";		
				String reportTitle = String.format("%s (%s)", title.replace(" Report", ""), criteria.toUpperCase());
				
				Map<String, Object> mapParameters = new HashMap<String, Object>();
				mapParameters.put("company", company);
				mapParameters.put("logo", this.getClass().getClassLoader().getResourceAsStream("Images/"+ company_logo));
				mapParameters.put("prepared_by", UserInfo.Alias);
				mapParameters.put("date_from", date_fr);	
				mapParameters.put("date_to", date_to);		
				mapParameters.put("req_type_id", req_type_id);	
				mapParameters.put("req_type_name", req_type_name);	
				mapParameters.put("payee_id", payee_id);	
				mapParameters.put("payee_name", payee_name);	
				mapParameters.put("availer_id", availer_id);	
				mapParameters.put("availer_name", availer_name);
				mapParameters.put("prepared_id", prepared_by_id);	
				mapParameters.put("prepared_name", prepared_by_name);	
				mapParameters.put("status_id", status_id);	
				mapParameters.put("status_name", status_name);
				mapParameters.put("pmt_type_name", pmt_type_name);	
				mapParameters.put("pmt_type_id", pmt_type_id);	
				mapParameters.put("pv_from", pv_fr);	
				mapParameters.put("pv_to", pv_to);

				FncReport.generateReport("/Reports/rptPV_withoutDV.jasper", reportTitle, "", mapParameters);
				System.out.println("PV w/out DV");
			}else {
				String criteria = "PV Prooflist";		
				String reportTitle = String.format("%s (%s)", title.replace(" Report", ""), criteria.toUpperCase());
				
				Map<String, Object> mapParameters = new HashMap<String, Object>();
				mapParameters.put("co_id", co_id);
				mapParameters.put("company", company);
				mapParameters.put("logo", this.getClass().getClassLoader().getResourceAsStream("Images/"+ company_logo));
				mapParameters.put("prepared_by", UserInfo.Alias);
				mapParameters.put("date_from", date_fr);	
				mapParameters.put("date_to", date_to);		
				mapParameters.put("req_type_id", req_type_id);	
				mapParameters.put("req_type_name", req_type_name);	
				mapParameters.put("payee_id", payee_id);	
				mapParameters.put("payee_name", payee_name);	
				mapParameters.put("availer_id", availer_id);	
				mapParameters.put("availer_name", availer_name);
				mapParameters.put("prepared_id", prepared_by_id);	
				mapParameters.put("prepared_name", prepared_by_name);	
				mapParameters.put("status_id", status_id);	
				mapParameters.put("status_name", status_name);
				mapParameters.put("pmt_type_name", pmt_type_name);	
				mapParameters.put("pmt_type_id", pmt_type_id);	
				mapParameters.put("pv_from", pv_fr);	
				mapParameters.put("pv_to", pv_to);
				
				System.out.printf("co_id: %s\n", co_id);
				System.out.printf("pv_from: %s\n", pv_fr);
				System.out.printf("pv_to: %s\n", pv_to);
				System.out.printf("date_from: %s\n", date_fr);
				System.out.printf("date_to: %s\n", date_to);
				System.out.printf("req_type_id: %s\n", req_type_id);
				System.out.printf("payee_id: %s\n", payee_id);
				System.out.printf("availer_id: %s\n", availer_id);
				System.out.printf("prepared_id: %s\n", prepared_by_id);
				System.out.printf("pmt_type_id: %s\n", pmt_type_id);
				System.out.printf("status_id: %s\n", status_id);
				
				
				System.out.printf("SQL in report:%s\n", "select\n" + 
						"\n" + 
						"a.pv_no,\n" + 
						"to_char(a.pv_date,'MM-dd-yyyy') as pv_date,\n" + 
						"(case when a.pay_type_id = 'A' then 'Cash' else 'Check' end) as pmt_tpye,\n" + 
						"c.rplf_type_desc,\n" + 
						"trim(d.entity_name) as payee,\n" + 
						"trim(e.entity_name) as availer,\n" + 
						"trim(a.remarks) as particular,\n" + 
						"f.amt_payable,\n" + 
						"g.status_desc,\n" + 
						"coalesce(h.date_paid,null) as date_paid\n" + 
						"\n" + 
						"from rf_pv_header a\n" + 
						"left join rf_request_header b on a.pv_no = b.rplf_no and a.co_id = b.co_id\n" + 
						"left join mf_rplf_type c on b.rplf_type_id = c.rplf_type_id\n" + 
						"left join rf_entity d on a.entity_id1 = d.entity_id\n" + 
						"left join rf_entity e on a.entity_id2 = e.entity_id\n" + 
						"left join ( select distinct on (pv_no) pv_no, sum(tran_amt) as amt_payable from rf_pv_detail where status_id != 'I' and acct_id = '03-01-01-001' group by pv_no ) f on a.pv_no = f.pv_no\n" + 
						"left join mf_record_status g on a.status_id = g.status_id\n" + 
						"left join rf_cv_header h on a.cv_no = h.cv_no and a.co_id = h.co_id\n" + 
						"\n" + 
						"where a.pv_no != ''\n" + 
						"and a.pv_date::date >= '"+date_fr+"'\n" + 
						"and a.pv_date::date <= '"+date_to+"'\n" + 
						"and a.co_id = '"+co_id+"'\n" + 
						"and ( case when '"+req_type_id+"' = '' or '"+req_type_id+"' is null then a.pv_no is not null else b.rplf_type_id = '"+req_type_id+"'  end )\n" + 
						"and ( case when '"+payee_id+"' = '' or '"+payee_id+"' is null then a.pv_no is not null else a.entity_id1 = '"+payee_id+"'  end )\n" + 
						"and ( case when '"+availer_id+"' = '' or '"+availer_id+"' is null then a.pv_no is not null else a.entity_id2 = '"+availer_id+"'  end )\n" + 
						"and ( case when '"+prepared_by_id+"' = '' or '"+prepared_by_id+"' is null then a.pv_no is not null else a.created_by = '"+prepared_by_id+"'  end )\n" + 
						"and ( case when '"+pv_fr+"' = 0 or '"+pv_fr+"' is null then a.pv_no is not null else a.pv_no::int >= '"+pv_fr+"'   end )\n" + 
						"and ( case when '"+pv_to+"' = 0 or '"+pv_to+"' is null then a.pv_no is not null else a.pv_no::int <= '"+pv_to+"'  end )\n" + 
						"and ( case when '"+pmt_type_id+"' = '' then a.pv_no is not null else a.pay_type_id = '"+pmt_type_id+"' end )\n" + 
						"and ( case when '"+status_id+"' = '' then a.pv_no is not null else a.status_id = '"+status_id+"' end )\n" + 
						"\n" + 
						"order by a.pv_no");
				
				//FncReport.generateReport("/Reports/rptPV_prooflist.jasper", reportTitle, "", mapParameters);
				FncReport.generateReport("/Reports/rptPV_prooflist_v2.jasper", reportTitle, "", mapParameters);
			}
		}
		if(e.getActionCommand().equals("Cancel")){	
			refreshFields();
			enableButton(false, false, true);
		}
		
		if(e.getActionCommand().equals("Preview By Batch")) {/*ADDED BY JED 2021-02-01 DCRF NO. 1562 : PREVIEW PV BY BATCH*/
			
//			displayPVProoflistByBatch(modelPVBatch, rowHeaderPVBatch, co_id, pv_fr, pv_to, date_fr, date_to, req_type_id, payee_id, availer_id, prepared_by_id, status_id, pmt_type_id);
			
//			JOptionPane.showOptionDialog(getContentPane(), pnlBatch, "Preview By Batch",
//					JOptionPane.PLAIN_MESSAGE, JOptionPane.PLAIN_MESSAGE, null, new Object[] {}, null);
			
			pnlPVBatch = new PVProoflistByBatch(FncGlobal.homeMDI, "PV Prooflist By Batch", co_id, pv_fr, pv_to, date_fr, date_to, req_type_id, payee_id, availer_id, prepared_by_id, status_id, pmt_type_id, company);
			pnlPVBatch.setLocationRelativeTo(this);
			pnlPVBatch.setVisible(true);
			
		}
	}

	private void enabledFields(boolean x){
		
		lblPVFrom.setEnabled(x);		
		txtPVfrom.setEnabled(x);	
		lblPVTo.setEnabled(x);	
		txtPVto.setEnabled(x);	
		lblDateFrom.setEnabled(x);			
		dteDateFrom.setEnabled(x);
		lblDateTo.setEnabled(x);	
		dateDateTo.setEnabled(x);
		
		lblDateRequest.setEnabled(x);	
		lblPayee.setEnabled(x);	
		lblAvailer.setEnabled(x);	
		lblStatus.setEnabled(x);	
		lblPVStatus.setEnabled(x);	
		lblPaymentType.setEnabled(x);
		
		lookupRequestType.setEnabled(x);	
		lookupPayee1.setEnabled(x);	
		lookupPayee2.setEnabled(x);	
		lookupStatus.setEnabled(x);	
		lookupPreparedby.setEnabled(x);	
		lookupPmtType.setEnabled(x);	
		
		tagReqType.setEnabled(x);	
		tagPayee1.setEnabled(x);	
		tagPayee2.setEnabled(x);
		tagStatus.setEnabled(x);	
		tagPreparedBy.setEnabled(x);
		tagPmtType.setEnabled(x);		
		
		txtPVfrom.setEnabled(x);
		txtPVto.setEnabled(x);
		
		
	}
	
	/*ADDED BY JED 2021-02-01 DCRF NO. 1562 : CONTROL OF BUTTONS*/
	private void enableButton(boolean x, boolean y, boolean z) {
		
		btnPreview.setEnabled(x);
		btnPrevByBatch.setEnabled(y);
		btnCancel.setEnabled(z);
		
	}
	
	
	private void refreshFields(){
		
		lookupRequestType.setValue("");	
		lookupPayee1.setValue("");	
		lookupPayee2.setValue("");		
		lookupStatus.setValue("");	
		lookupPreparedby.setValue("");	
		lookupPmtType.setValue("");
		
		tagReqType.setTag("");
		tagPayee1.setTag("");
		tagPayee2.setTag("");	
		tagStatus.setTag("");	
		tagPreparedBy.setTag("");
		tagPmtType.setTag("");		
		
		dteDateFrom.setDate(null);
		dateDateTo.setDate(null);
		
		req_type_id 	= "";
		req_type_name	= "";
		payee_id 		= "";
		payee_name		= "";
		availer_id 		= "";
		availer_name 	= "";
		prepared_by_id	= "";
		prepared_by_name= "";
		status_id		= "";
		status_name		= "";
		pmt_type_id		= "";
		pmt_type_name	= "";
		
		txtPVfrom.setText("");
		txtPVto.setText("");
		
		chkPVwithoutDV.setEnabled(false);
		chkPVwithoutDV.setSelected(false);
		
	}
	
	private void initialize_comp(){		
		
		co_id 		= "02";	
		company		= "CENQHOMES DEVELOPMENT CORPORATION";
		company_logo = RequestForPayment.sql_getCompanyLogo();		
		txtCompany.setText(company);

		enabledFields(true);
		enableButton(false, false, true);
		lookupRequestType.setLookupSQL(getRequestType());	
		lookupPayee1.setLookupSQL(getPayee());	
		lookupPayee2.setLookupSQL(getAvailer());
		lookupPreparedby.setLookupSQL(getPreparedBy());	
		lookupPmtType.setLookupSQL(getPayment_type());	
		lookupStatus.setLookupSQL(getStatus());	
		
		lookupCompany.setValue(co_id);
	}
	
	
	//lookup
	private String getRequestType(){

		String sql = 
		"select " +
		"rplf_type_id as \"Type ID\",  \n" +
		"trim(rplf_type_desc) as \"Description\"  \n" +
		"from mf_rplf_type where status_id = 'A' " +
		"order by rplf_type_id    ";		
		return sql;

	}	
	
	private String getPayee(){

		String sql = 
		"select distinct on (a.name) * from (\r\n" + 
		"\r\n" + 
		"select \r\n" + 
		"\r\n" + 
		"a.entity_id1,\r\n" + 
		"upper(trim(b.entity_name)) as name\r\n" + 
		"\r\n" + 
		"from rf_request_header a \r\n" + 
		"left join rf_entity b on a.entity_id1 = b.entity_id ) a\r\n" + 
		"\r\n" + 
		"order by a.name";		
		return sql;

	}	
	
	private String getAvailer(){

		String sql = 
		"select distinct on (a.name) * from (\r\n" + 
		"\r\n" + 
		"select \r\n" + 
		"\r\n" + 
		"a.entity_id,\r\n" + 
		"upper(trim(b.entity_name)) as name\r\n" + 
		"\r\n" + 
		"from rf_request_detail a \r\n" + 
		"left join rf_entity b on a.entity_id = b.entity_id ) a\r\n" + 
		"\r\n" + 
		"order by a.name";		
		return sql;

	}	
		
	private String getPreparedBy(){

		String sql = 
		"select distinct on (a.name) * from (\r\n" + 
		"\r\n" + 
		"select \r\n" + 
		"\r\n" + 
		"a.created_by,\r\n" + 
		"upper(trim(c.last_name))||', '||upper(trim(c.first_name)) as name\r\n" + 
		"\r\n" + 
		"from rf_pv_header a \r\n" + 
		"left join em_employee b on a.created_by = b.emp_code\r\n" + 
		"left join rf_entity c on b.entity_id = c.entity_id    \n" +
		"\r\n" + 
		") a\r\n" + 
		"\r\n" + 
		"order by a.name";		
		return sql;

	}	
		
	private String getStatus(){

		String sql = 
		"select \n" +

		"a.status_id, \n" +
		"b.status_desc \n" +

        "from (select distinct on(status_id) status_id from rf_pv_header) a  \n" +
        "left join mf_record_status b on a.status_id = b.status_id \n" ;	
        		
		return sql;

	}	
	
	private String getPayment_type(){//used
		return 
		"select 'B' as \"Code\", 'CHECK' as \"Payment Type\" union all "  +
		"select 'A' as \"Code\", 'CASH'  as \"Payment Type\"   "  ;
	}
	
	public static void Dispose() {
		
		pnlPVBatch.dispose();
		
	}
}
