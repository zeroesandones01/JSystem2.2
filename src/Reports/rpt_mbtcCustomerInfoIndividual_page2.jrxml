<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="612" pageHeight="792" columnWidth="612" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="2.2000000000000557"/>
	<property name="ireport.x" value="265"/>
	<property name="ireport.y" value="567"/>
	<property name="ireport.background.image.properties" value="true,true,0.25,-8,-8,0,0,2566,4216"/>
	<style name="style1"/>
	<parameter name="batch_no" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT A.c_last_name, A.c_first_name, A.c_middle_name,
TRIM(A.c_permaaddress) || CASE WHEN COALESCE(A.c_city, '') != '' THEN ', ' ELSE '' END || UPPER(COALESCE(TRIM(A.c_city), '')) as c_PermaAddress,
A.c_mobile, A.c_email, '534-2237' as BusinessNumber,
LPAD(DATE_PART('month', A.c_birthdate::DATE)::CHAR(2), 2, '0') as MM,
LPAD(DATE_PART('day', A.c_birthdate::DATE)::CHAR(2), 2, '0') as dd,
DATE_PART('year', A.c_birthdate::DATE)::CHAR(4) as year,
UPPER(
(
	CASE
		WHEN COALESCE((SELECT X.city_name FROM mf_city X WHERE X.city_id = B.birth_place), '') = ''
			THEN
				(
					CASE
						WHEN COALESCE((SELECT x.municipality_name FROM mf_municipality X WHERE X.municipality_id = B.birth_place), '') = ''
							THEN COALESCE((SELECT X.province_name FROM mf_province X WHERE X.province_id = B.birth_place), '')
						ELSE COALESCE((SELECT x.municipality_name FROM mf_municipality X WHERE X.municipality_id = B.birth_place), '')
					END
				)
		ELSE COALESCE((SELECT X.city_name FROM mf_city X WHERE X.city_id = B.birth_place), '')
	END
)) as c_birthplace, A.c_tin, A.c_nationality, A.c_first_name || A.c_middle_name || A.c_last_name as PrintedName,
(
	select X.connection_last_name || '		' || X.connection_first_name || '		' || X.connection_middle_name
	from rf_entity_connect X
	where X.entity_id = B.entity_id AND X.connect_type IN ('SC', 'SP') AND X.status_id = 'A' LIMIT 1
) as Spouse, A.c_mother as Mother,
CASE WHEN A.c_marital = 'S' THEN '/' ELSE '' END as Unmarried, CASE WHEN A.c_marital = 'M' THEN '/' ELSE '' END as Married,
'' as Separated, '' as Widowed, '' as Divorce,
(
	SELECT (CASE WHEN x.dependent_no > 0 THEN x.dependent_no WHEN COALESCE(x.dependent_no::CHAR(1), '') = '' THEN 0 ELSE x.dependent_no END)::text
	FROM rf_entity x
	WHERE x.entity_id = B.entity_id AND x.status_id = 'A'
) as NoChildren,
CASE WHEN A.c_gender = 'F' THEN '/' ELSE '' END as Female,
CASE WHEN A.c_gender = 'M' THEN '/' ELSE '' END as Male,
(
SELECT CASE WHEN length(id_desc)::INT > 24::INT THEN Y.id_alias ELSE Y.id_desc END AS id_alias
FROM rf_entity_submitted_id X
INNER JOIN mf_client_valid_id Y ON X.id_type::INTEGER = Y.id_no::INTEGER
WHERE X.entity_id = B.entity_id AND (Y.id_no::INTEGER = 9 OR '' = '') AND X.default_id = true
ORDER BY Y.id_no::INTEGER ASC LIMIT 1
) as IDType,
(
SELECT X.id_no
FROM rf_entity_submitted_id X
INNER JOIN mf_client_valid_id Y ON X.id_type::INTEGER = Y.id_no::INTEGER
WHERE X.entity_id = B.entity_id AND (Y.id_no::INTEGER = 9 OR '' = '') AND X.default_id = true
ORDER BY Y.id_no::INTEGER ASC LIMIT 1
) as IDNo, A.c_employer as Employer, A.c_job
FROM tmp_rtd_printing A
INNER JOIN rf_entity B ON A.c_last_name = B.last_name AND A.c_first_name = B.first_name AND A.c_middle_name = B.middle_name
INNER JOIN mf_project C ON A.c_project = C.proj_name
INNER JOIN mf_unit_info D ON C.proj_id = D.proj_id AND TRIM(A.c_unit) = TRIM(D.description)
INNER JOIN rf_sold_unit E ON B.entity_id = E.entity_id AND C.proj_id = E.projcode AND D.pbl_id = E.pbl_id
LEFT JOIN rf_rtd_enrolled F ON B.entity_id = F.c_entity_id AND C.proj_id = F.c_proj_id AND D.pbl_id = F.c_pbl_id AND E.seq_no::INT = F.c_seq_no::INT
WHERE (COALESCE(F.batch_no, '') = $P{batch_no} OR $P{batch_no} = '') AND F.tobeprinted::INTEGER = 1::INTEGER
ORDER BY A.c_last_name, A.c_first_name, A.c_middle_name]]>
	</queryString>
	<field name="c_last_name" class="java.lang.String"/>
	<field name="c_first_name" class="java.lang.String"/>
	<field name="c_middle_name" class="java.lang.String"/>
	<field name="c_permaaddress" class="java.lang.String"/>
	<field name="c_mobile" class="java.lang.String"/>
	<field name="c_email" class="java.lang.String"/>
	<field name="businessnumber" class="java.lang.String"/>
	<field name="mm" class="java.lang.String"/>
	<field name="dd" class="java.lang.String"/>
	<field name="year" class="java.lang.String"/>
	<field name="c_birthplace" class="java.lang.String"/>
	<field name="c_tin" class="java.lang.String"/>
	<field name="c_nationality" class="java.lang.String"/>
	<field name="printedname" class="java.lang.String"/>
	<field name="spouse" class="java.lang.String"/>
	<field name="mother" class="java.lang.String"/>
	<field name="unmarried" class="java.lang.String"/>
	<field name="married" class="java.lang.String"/>
	<field name="separated" class="java.lang.String"/>
	<field name="widowed" class="java.lang.String"/>
	<field name="divorce" class="java.lang.String"/>
	<field name="nochildren" class="java.lang.String"/>
	<field name="female" class="java.lang.String"/>
	<field name="male" class="java.lang.String"/>
	<field name="idtype" class="java.lang.String"/>
	<field name="idno" class="java.lang.String"/>
	<field name="employer" class="java.lang.String"/>
	<field name="c_job" class="java.lang.String"/>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="776" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="198" y="283" width="113" height="28"/>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{c_last_name} + ", " + $F{c_first_name} + " " + $F{c_middle_name}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="198" y="376" width="113" height="28"/>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{c_last_name} + ", " + $F{c_first_name} + " " + $F{c_middle_name}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
